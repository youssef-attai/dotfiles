#!/bin/bash

# This script takes a screenshot and saves it to ~/Pictures/Screenshots
# Usage: take_screenshot.sh [area|window|desktop]
# optional argument: clipboard
# Dependencies: maim, dunstify

icon="$HOME/Pictures/svg/camera.svg"

function send_notification_screenshot_saved() {
  dunstify -a "takescreenshot" -r 9995 -i $icon "Screenshot saved" -t 2000 -u low
}

function send_notification_screenshot_copied() {
  dunstify -a "takescreenshot" -r 9995 -i $icon "Screenshot copied" -t 2000 -u low
}

function play_screenshot_sound() {
  paplay $HOME/.local/share/sounds/screenshot-sound.mp3
}

if [ -z "$1" ]; then
  echo "Usage: take_screenshot.sh [area|window|desktop]"
  exit 1
fi

if [ "$2" == "clipboard" ]; then
  case $1 in
  area)
    maim -s | xclip -selection clipboard -t image/png
    send_notification_screenshot_copied
    play_screenshot_sound
    ;;
  window)
    maim -i $(xdotool getactivewindow) | xclip -selection clipboard -t image/png
    send_notification_screenshot_copied
    play_screenshot_sound
    ;;
  desktop)
    maim | xclip -selection clipboard -t image/png
    send_notification_screenshot_copied
    play_screenshot_sound
    ;;
  esac
  exit 0
fi

case $1 in
area)
  maim -s ~/Pictures/Screenshots/$(date +%Y-%m-%d_%H-%M-%S).png
  send_notification_screenshot_saved
  play_screenshot_sound
  ;;
window)
  maim -i $(xdotool getactivewindow) ~/Pictures/Screenshots/$(date +%Y-%m-%d_%H-%M-%S).png
  send_notification_screenshot_saved
  play_screenshot_sound
  ;;
desktop)
  maim ~/Pictures/Screenshots/$(date +%Y-%m-%d_%H-%M-%S).png
  send_notification_screenshot_saved
  play_screenshot_sound
  ;;
esac
